--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _fis4ACPmEeWuiIpNL9blpQ
Element-Name: ArrowKeyNavigationInVariables
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _dJsNsCPwEeWuiIpNL9blpQ
Runtime-Version: 1.5.5.201503020312
Save-Time: 11/6/15 12:56 PM
Tags: Unstable
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

with [get-view "Project Explorer" | get-tree] {
    select RobotProject | double-click
    select "RobotProject/TestFile.robot" | double-click
}


with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Variables | click
    with [get-table] {
    	//go to "tab" end edit value
        select "${scalar}" | key-type Right
        key-type Down
        select "@{tab}" | key-type Enter
        select "@{tab}" | activate-cell-edit -column 1
        click -default
        with [get-editbox] {
            key-type Right
            set-text "one  two  three  four with space  5"
            key-type Enter
        }
        apply-cell-edit -deactivate
        //fot to "scalar2" and change name
        key-type Down
        select "&{dict}" | key-type Down
        select "${scalar2}" | key-type Left
        key-type Enter
        select "${scalar2}" | activate-cell-edit
        click -default
        with [get-editbox] {
            set-text "${new_scalar}"
            key-type Enter
        }
        apply-cell-edit -deactivate
        //go to dict and changed name
        key-type Down
        select "@{tab2}" | key-type Down
        select "&{dict2}" | key-type Enter
        select "&{dict2}" | activate-cell-edit
        click -default
        with [get-editbox] {
            set-text "&{new_dict}"
            key-type Enter
        }
        apply-cell-edit -deactivate
        //go by arrow 5 time down (focus should stay in the last row)
        key-type Right
        key-type Down
        select "&{var}" | key-type Down
        select "...add new scalar" | key-type Down -times 5
    }
}
//checking where is focus
with [get-editor "TestFile.robot" | get-table] {
    get-item "...add new scalar" | get-property selected | equals true | verify-true
}

//check variables view after edition
with [get-editor "TestFile.robot" | get-table] {
    get-item "${scalar}" | get-property "values['Variable']" | equals "${scalar}" | verify-true
    get-item "${scalar}" | get-property "values['Value']" | equals 1 | verify-true
    get-item "${scalar}" | get-property "values['Comment']" | equals "" | verify-true
    get-item "@{tab}" | get-property "values['Variable']" | equals "@{tab}" | verify-true
    get-item "@{tab}" | get-property "values['Value']" | equals "one  two  three  four with space  5" | verify-true
    get-item "@{tab}" | get-property "values['Comment']" | equals "" | verify-true
    get-item "&{dict}" | get-property index | equals 2 | verify-true
    get-item "&{dict}" | get-property "values['Variable']" | equals "&{dict}" | verify-true
    get-item "&{dict}" | get-property "values['Value']" | equals "key=value  1=2  3=4" | verify-true
    get-item "&{dict}" | get-property "values['Comment']" | equals "" | verify-true
    get-item "${new_scalar}" | get-property "values['Variable']" | equals "${new_scalar}" | verify-true
    get-item "${new_scalar}" | get-property "values['Value']" | equals "scalar2 value" | verify-true
    get-item "${new_scalar}" | get-property "values['Comment']" | equals "" | verify-true
    get-item "@{tab2}" | get-property "values['Variable']" | equals "@{tab2}" | verify-true
    get-item "@{tab2}" | get-property "values['Value']" 
        | equals "56  text  \"Alice Cooper\"  ${tab_var}  @{new_list}  &{new_dict}   space was here" | verify-true
    get-item "@{tab2}" | get-property "values['Comment']" | equals "" | verify-true
    get-item "&{new_dict}" | get-property "values['Variable']" | equals "&{new_dict}" | verify-true
    get-item "&{new_dict}" | get-property "values['Value']" 
        | equals "1=value1  &{dict3}=value2  ${param}=${param}   =4" | verify-true
    get-item "&{new_dict}" | get-property "values['Comment']" | equals "" | verify-true
    get-item "&{var}" | get-property "values['Variable']" | equals "&{var}" | verify-true
    get-item "&{var}" | get-property "values['Value']" | equals "" | verify-true
    get-item "&{var}" | get-property "values['Comment']" | equals "" | verify-true
    get-property itemCount | equals 8 | verify-true
}

//go to "dict" in Edit Variable
with [get-editor "TestFile.robot"] {
    get-table | select "${scalar}"
    get-section "Edit Variable" | click
    get-table | select "&{dict}"
    with [get-section "Edit Variable" | get-table] {
        select 1 | key-type Right
        key-type Down
        select 2 | key-type Down
        select 3 | key-type Enter
        select 3 | activate-cell-edit -column 2
        click -default
        with [get-editbox] {
            set-text 9
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Left
        key-type Down
        //add new element
        select "...add new element" -column Key | key-type Enter
        click -default
        select 4 | activate-cell-edit -column 1
        with [get-editbox] {
            set-text 88
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Enter
        select 4 | activate-cell-edit -column 2
        click -default
        with [get-editbox] {
            set-text "new_value"
            key-type Enter
        }
        apply-cell-edit -deactivate
        //go 3 times at the ned (focus should stay in last row)
        key-type Right -times 3
    }
}

//check how 'dict' looks after editing
with [get-editor "TestFile.robot" | get-section "Edit Variable" | get-table] {
    get-item 4 | get-property selected | equals true | verify-true
    get-item 1 | get-property "values['Key']" | equals key | verify-true
    get-item 1 | get-property "values['No.']" | equals 1 | verify-true
    get-item 1 | get-property "values['Value']" | equals value | verify-true
    get-item 2 | get-property "values['Key']" | equals 1 | verify-true
    get-item 2 | get-property "values['No.']" | equals 2 | verify-true
    get-item 2 | get-property "values['Value']" | equals 2 | verify-true
    get-item 3 | get-property "values['Key']" | equals 3 | verify-true
    get-item 3 | get-property "values['No.']" | equals 3 | verify-true
    get-item 3 | get-property "values['Value']" | equals 9 | verify-true
    get-item 4 | get-property index | equals 3 | verify-true
    get-item 4 | get-property "values['Key']" | equals 88 | verify-true
    get-item 4 | get-property "values['No.']" | equals 4 | verify-true
    get-item 4 | get-property "values['Value']" | equals "new_value" | verify-true
}

//edit 'tab2'
with [get-editor "TestFile.robot"] {
    get-table | select "@{tab2}"
    with [get-section "Edit Variable" | get-table] {
        select 3 | key-type Up
        select 2 | key-type Up
        select 1 | key-type Up
        select 0 | key-type Enter
        select 0 | activate-cell-edit -column 1
        click -default
        with [get-editbox] {
            set-text 100
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Down
        select 1 | key-type Down
        select 2 | key-type Down
        select 3 | key-type Down
        select 4 | key-type Down
        select 5 | key-type Enter
        select 5 | activate-cell-edit -column 1
        click -default
        with [get-editbox] {
            set-text ""
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Down
        select 6 | key-type Down
        //add new value
        select "...add new element" -column Value | key-type Enter
        click -default
        select 7 | activate-cell-edit -column 1
        with [get-editbox] {
            set-text "new item in table"
            key-type Enter
        }
        apply-cell-edit -deactivate
    }
}
//check how it looks after editing
with [get-editor "TestFile.robot" | get-section "Edit Variable" | get-table] {
    get-item 7 | get-property selected | equals true | verify-true
    get-item 0 | get-property "values['Index']" | equals 0 | verify-true
    get-item 0 | get-property "values['Value']" | equals 100 | verify-true
    get-item 1 | get-property "values['Index']" | equals 1 | verify-true
    get-item 1 | get-property "values['Value']" | equals text | verify-true
    get-item 2 | get-property "values['Index']" | equals 2 | verify-true
    get-item 2 | get-property "values['Value']" | equals "\"Alice Cooper\"" | verify-true
    get-item 3 | get-property "values['Index']" | equals 3 | verify-true
    get-item 3 | get-property "values['Value']" | equals "${tab_var}" | verify-true
    get-item 4 | get-property "values['Index']" | equals 4 | verify-true
    get-item 4 | get-property "values['Value']" | equals "@{new_list}" | verify-true
    get-item 5 | get-property "values['Index']" | equals 5 | verify-true
    get-item 5 | get-property "values['Value']" | equals "" | verify-true
    get-item 6 | get-property "values['Index']" | equals 6 | verify-true
    get-item 6 | get-property "values['Value']" | equals "space was here" | verify-true
    get-item 7 | get-property "values['Index']" | equals 7 | verify-true
    get-item 7 | get-property "values['Value']" | equals "new item in table" | verify-true
    get-property itemCount | equals 9 | verify-true
}
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

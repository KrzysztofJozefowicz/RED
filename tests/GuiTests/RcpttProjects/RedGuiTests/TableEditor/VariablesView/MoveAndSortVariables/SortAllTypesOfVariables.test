--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _9mJtcCGJEeWIFM1C_X1kYg
Element-Name: SortAllTypesOfVariables
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _2ctFsCFhEeWIFM1C_X1kYg
Runtime-Version: 1.5.5.201503020312
Save-Time: 7/3/15 4:36 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-editor "TestFile.robot" | get-tab-folder | get-tab-item Variables | click

        
//----------------------------------------  sort by name ----------------------------------------------------
//not sorted
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_not_sorted.csv" $RCPTT_project_path]]]

//sort asc
with [get-editor "TestFile.robot" | get-table | get-column-header Variable] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_sorted_asc_by_name.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 128 | verify-true

//sort dec by name
with [get-editor "TestFile.robot" | get-table | get-column-header Variable] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_sorted_des_by_name.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 1024 | verify-true

//not sorted
with [get-editor "TestFile.robot" | get-table | get-column-header Variable] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_not_sorted.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 0 | verify-true
//-----------------------------------      sort by value  ----------------------------------


//sort asc by value
with [get-editor "TestFile.robot" | get-table | get-column-header Value] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_sorted_asc_by_value.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 128 | verify-true

//sort dec by name
with [get-editor "TestFile.robot" | get-table | get-column-header Value] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_sorted_des_by_value.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 1024 | verify-true

//not sorted
with [get-editor "TestFile.robot" | get-table | get-column-header Value] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_not_sorted.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 0 | verify-true

//-----------------------------------      sort by comment  ----------------------------------


//sort asc by name
with [get-editor "TestFile.robot" | get-table | get-column-header Comment] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_sorted_asc_by_comment.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 128 | verify-true

//sort dec by name
with [get-editor "TestFile.robot" | get-table | get-column-header Comment] {
    click
}
assert-tables-match [get-editor "TestFile.robot" | get-table | get-table-data]
[ read-csv-file [uri-from-path [format "%s/TableEditor/VariablesView/MoveAndSortVariables/TestData/all_var_sorted_des_by_comment.csv" $RCPTT_project_path]]]
get-editor "TestFile.robot" | get-table | get-property "getSortDirection()" | equals 1024 | verify-true
  
//sort by name again and save  
with [get-editor "TestFile.robot" | get-table] {
    get-column-header Variable | click
}        
//check if soring not changed  Source      
get-editor "TestFile.robot" | get-tab-folder | get-tab-item Source | click
get-editor "TestFile.robot" | get-text-viewer | get-property text | equals "*** Variables ***\n"
    + "${a}    text    # test1\n"
    + "${A}    a    # test2\n"
    + "${zrr}    Z    # test2\n"
    + "${1}    abba    # Zorro\n"
    + "${5}    !not touch    # 4\n"
    + "${a}    1 2 3 4 5    # 6\n"
    + "${calar}    not tab!    # 200\n"
    + "${c}    $a    # _comment\n"
    + "@{a}    $1 @tab2    # comment\n"
    + "${a}    one two $three    # Belt\n"
    + "@{101}    &dict\n"
    + "&{dict}    $key=value  [list]\n"
    + "${var1}    @map\n"
    + "&{Dict2}\n"
    + "${var2}    @map  $parm \"1\" list 89    # space 2" | verify-true
    
 
//close editor and check if Souce was chanaged  (sorting is reset)
 get-editor "TestFile.robot" | close
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-editor "TestFile.robot" | get-text-viewer | get-property text | equals "*** Variables ***\n"
    + "${a}    text    # test1\n"
    + "${A}    a    # test2\n"
    + "${zrr}    Z    # test2\n"
    + "${1}    abba    # Zorro\n"
    + "${5}    !not touch    # 4\n"
    + "${a}    1 2 3 4 5    # 6\n"
    + "${calar}    not tab!    # 200\n"
    + "${c}    $a    # _comment\n"
    + "@{a}    $1 @tab2    # comment\n"
    + "${a}    one two $three    # Belt\n"
    + "@{101}    &dict\n"
    + "&{dict}    $key=value  [list]\n"
    + "${var1}    @map\n"
    + "&{Dict2}\n"
    + "${var2}    @map  $parm \"1\" list 89    # space 2" | verify-true

//add new varaible, sort, and save
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Variables | click
    with [get-table] {
        select "...add new scalar" | key-type Enter
        select "${var3}" | activate-cell-edit
        apply-cell-edit -deactivate
        select "${var3}" | double-click
        select "${var3}" | activate-cell-edit -column 1
        with [get-editbox] {
            set-text "new value"
            key-type "NUMPAD_ENTER" "\\u000D"
        }
        apply-cell-edit -deactivate
        get-column-header Value | click
        key-type "M1+s"
    }
    get-tab-folder | get-tab-item Source | click
    close
}

//check if new scalar was added to the end
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-editor "TestFile.robot" | get-text-viewer | get-property text | equals "*** Variables ***\n"
    + "${a}    text    # test1\n"
    + "${A}    a    # test2\n"
    + "${zrr}    Z    # test2\n"
    + "${1}    abba    # Zorro\n"
    + "${5}    !not touch    # 4\n"
    + "${a}    1 2 3 4 5    # 6\n"
    + "${calar}    not tab!    # 200\n"
    + "${c}    $a    # _comment\n"
    + "@{a}    $1 @tab2    # comment\n"
    + "${a}    one two $three    # Belt\n"
    + "@{101}    &dict\n"
    + "&{dict}    $key=value  [list]\n"
    + "${var1}    @map\n"
    + "&{Dict2}\n"
    + "${var2}    @map  $parm \"1\" list 89    # space 2\n"
    + "${var3}    new value" | verify-true   
    
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: MenuOnItemsInKeywordsTable
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _46WUAFTXEea8WJ7bbC6OBw
Runtime-Version: 2.1.0.201606221726
Save-Time: 7/28/16 7:01 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

	
proc "check-submenu-for-kw" [val row_enabled true]{	
	//check sub,enu
	with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
	
	    get-menu "Table/Insert cell" | get-property enablement | equals false | verify-true
	    get-menu "Table/Insert cell" | get-property index | equals 0 | verify-true
	    
	    get-menu "Table/Delete cell" | get-property enablement | equals false | verify-true
	    get-menu "Table/Delete cell" | get-property index | equals 1 | verify-true
	    
	    get-menu "Table/Expand All" | get-property enablement | equals true | verify-true
	    get-menu "Table/Expand All" | get-property index | equals 3 | verify-true
	    
	    get-menu "Table/Collapse All" | get-property enablement | equals true | verify-true
	    get-menu "Table/Collapse All" | get-property index | equals 4 | verify-true
	}
	
	
	with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
	    get-menu "Row/Move up" | get-property enablement | equals $row_enabled | verify-true
	    get-menu "Row/Move up" | get-property index | equals 0 | verify-true
	    get-menu "Row/Move up" | get-property accelerator | equals "M1+Up" | verify-true
	    
	    get-menu "Row/Move down" | get-property enablement | equals  $row_enabled | verify-true
	    get-menu "Row/Move down" | get-property index | equals 1 | verify-true
	    get-menu "Row/Move down" | get-property accelerator | equals "M1+Down" | verify-true
	    
	    get-menu "Row/Cut row" | get-property enablement | equals  $row_enabled | verify-true
	    get-menu "Row/Cut row" | get-property index | equals 3 | verify-true
	    get-menu "Row/Cut row" | get-property accelerator | equals "M1+M2+X" | verify-true
	    
	    get-menu "Row/Copy row" | get-property enablement | equals  $row_enabled | verify-true
	    get-menu "Row/Copy row" | get-property index | equals 4 | verify-true
	    get-menu "Row/Copy row" | get-property accelerator | equals "M1+M2+C" | verify-true
	    
	    get-menu "Row/Paste row" | get-property enablement | equals  false| verify-true
	    get-menu "Row/Paste row" | get-property index | equals 5 | verify-true
	    get-menu "Row/Paste row" | get-property accelerator | equals "M1+M2+V" | verify-true
	    
	    get-menu "Row/Delete row" | get-property enablement | equals  $row_enabled | verify-true
	    get-menu "Row/Delete row" | get-property index | equals 6 | verify-true
	    get-menu "Row/Delete row" | get-property accelerator | equals "M1+Delete" | verify-true
	    
	    get-menu "Row/Select whole row(s)" | get-property enablement | equals  true| verify-true
	    get-menu "Row/Select whole row(s)" | get-property index | equals 8 | verify-true
	    get-menu "Row/Select whole row(s)" | get-property accelerator | equals "M1+M2+A" | verify-true
	}
}

proc "check-menu-for-kw" [val row_enabled true]{
	get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1 | get-menu Paste 
	
	with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
	    get-property "getMenu().getItems().MenuItem[0].getEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[0].getToolTipText()" | equals "Add new element" | verify-true
	    get-property "getMenu().getItems().MenuItem[0].getText()" | equals "Add new keyword" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[1].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[1].getStyle()" | equals "[SEPARATOR]" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[2].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[2].getToolTipText()" | equals "Show in source" | verify-true
	    get-property "getMenu().getItems().MenuItem[2].getText()" | equals "Show in source\\9F4" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[3].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[3].getStyle()" | equals "[SEPARATOR]" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[4].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[4].getToolTipText()" | equals Cut | verify-true
	    get-property "getMenu().getItems().MenuItem[4].getText()" | equals "Cut\\9M1+X" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[5].getEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[5].getToolTipText()" | equals Copy | verify-true
	    get-property "getMenu().getItems().MenuItem[5].getText()" | equals "Copy\\9M1+C" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[6].isEnabled()" | equals false | verify-true
	    get-property "getMenu().getItems().MenuItem[6].getToolTipText()" | equals Paste | verify-true
	    get-property "getMenu().getItems().MenuItem[6].getText()" | equals "Paste\\9M1+V" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[7].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[7].getToolTipText()" | equals Delete | verify-true
	    get-property "getMenu().getItems().MenuItem[7].getText()" | equals "Delete\\9Delete" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[8].getEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[8].getStyle()" | equals "[SEPARATOR]" | verify-true
	
	}    
	check-submenu-for-kw
}	
	
proc "check-menu-for-buton" [val add_new_kw true] [val row_enabled true]{
	get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1 | get-menu Paste 
	
	with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
	    get-property "getMenu().getItems().MenuItem[0].getEnabled()" | equals false | verify-true
	    get-property "getMenu().getItems().MenuItem[0].getToolTipText()" | equals "Add new element" | verify-true
	    get-property "getMenu().getItems().MenuItem[0].getText()" | equals "Add new keyword" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[1].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[1].getStyle()" | equals "[SEPARATOR]" | verify-true

	    get-property "getMenu().getItems().MenuItem[2].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[2].getToolTipText()" | equals Cut | verify-true
	    get-property "getMenu().getItems().MenuItem[2].getText()" | equals "Cut\\9M1+X" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[3].getEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[3].getToolTipText()" | equals Copy | verify-true
	    get-property "getMenu().getItems().MenuItem[3].getText()" | equals "Copy\\9M1+C" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[4].isEnabled()" | equals false | verify-true
	    get-property "getMenu().getItems().MenuItem[4].getToolTipText()" | equals Paste | verify-true
	    get-property "getMenu().getItems().MenuItem[4].getText()" | equals "Paste\\9M1+V" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[5].isEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[5].getToolTipText()" | equals Delete | verify-true
	    get-property "getMenu().getItems().MenuItem[5].getText()" | equals "Delete\\9Delete" | verify-true
	    
	    get-property "getMenu().getItems().MenuItem[6].getEnabled()" | equals true | verify-true
	    get-property "getMenu().getItems().MenuItem[6].getStyle()" | equals "[SEPARATOR]" | verify-true
	
	}    
	check-submenu-for-kw -row_enabled "false"
}


get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | select "RobotProject/TestFile.robot" 
    | double-click

get-editor "TestFile.robot" | get-text-viewer | set-text "*** Test Cases ***\n"
    + "test\n"
    + "    log  7\n"
    + "*** Keyword ***\n"
    + "Simple test\n"
    + "    [Documentation]    simple doc\n"
    + "    log  7" 

with [get-editor "TestFile.robot"] {
    with [get-text-viewer] {
        set-caret-pos 3 11
        key-type "M1+s"
    }
    get-tab-folder | get-tab-item Keywords | click
}
get-view Outline | get-tree | select "TestFile.robot/Keywords/Simple test"


//check menu on first line
check-menu-for-kw

//set focus on Documentation
with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
    key-type Right
    key-type Left
    key-type Down
}

check-menu-for-kw

//set focus on keyword "log"
with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
    key-type Down
}

check-menu-for-kw

//set focus on "..."
with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
    key-type Down
}

check-menu-for-buton

//set focus on "..add new kw"
with [get-editor "TestFile.robot" | get-canvas -after [get-label "User Keywords"] -index 1] {
    key-type Down
}
check-menu-for-buton


------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

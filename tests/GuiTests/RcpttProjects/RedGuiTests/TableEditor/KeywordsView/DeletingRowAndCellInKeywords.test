--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _7-QNADzcEeWxlsQvwWxD9w
Element-Name: DeletingRowAndCellInKeywords
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _Qzt-MD0YEeWUyZKiCzynFQ
Runtime-Version: 2.0.0.201506120617
Save-Time: 8/13/15 9:44 AM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

//open editor
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-editor "TestFile.robot" | get-tab-folder | get-tab-item Keywords | click
with [get-editor "TestFile.robot"] {
    get-link "Section is not yet defined, do you want to create it?" | click
    wait 500
}  


//add keyword by navigation by arrows and accpet by Enter
add-keyword-with-elements-by-arrows -keyword_name "Example 1" -elements [list "@{list} =" "Create List"  "first" "second" "third"] -script_name "TestFile.robot"
add-row-to-keyword-by-arrows-end-enter -keyword_name "Example 1" -keyword_index 0 -elements [list "Length Should Be" "${list}" "3"] -script_name "TestFile.robot"
add-row-to-keyword-by-arrows-end-enter -keyword_name "Example 1" -keyword_index 0 -elements [list "Log Many" "@{list}"] -script_name "TestFile.robot"

//add keyword by double click
add-keyword-with-elements-by-double-click -keyword_name "Open Login Page" -elements [list "Open Browser" "http://host/login.html"]  -script_name "TestFile.robot"
add-row-to-keyword-by-double-click-on-cell -keyword_name "Open Login Page" -keyword_index 0 -elements [list "Title Should Be"  "Login Page"] -command_index 0 -script_name "TestFile.robot"

//add keywords with arguments
add-keyword-with-args-by-arrows -keywords_name "Three aruments" -arguments [list "${arg1}" "${arg2}" "${arg3}"] -script_name "TestFile.robot"
add-row-to-keyword-by-arrows-end-enter -keyword_name "Three aruments"  -keyword_index 0 -elements [list "Log" "1st argument: ${arg1}"] -script_name "TestFile.robot"
add-row-to-keyword-by-arrows-end-enter -keyword_name "Three aruments"  -keyword_index 0 -elements [list "Log" "2nd argument: ${arg2}"] -script_name "TestFile.robot"
add-row-to-keyword-by-arrows-end-enter -keyword_name "Three aruments"  -keyword_index 0 -elements [list "Log" "3rd argument: ${arg3}"] -script_name "TestFile.robot"
add-keyword-by-double-click -keywords_list [list "Empty Keyword 1" "Empty keyword 2"]-script_name "TestFile.robot"
add-keyword-with-elements-by-double-click -keyword_name "WWW sum 2 digits" -elements [list "${b} =" "set variable" "${1}"] -script_name "TestFile.robot"

//select cells and rows and delete
with [get-editor "TestFile.robot" | get-tree] {
	//delete keyword with all its lines:
    select "Three aruments" | key-type "M1+DEL"
    //remove empty keyword
    select "Empty keyword 2" | key-type "M1+DEL"
    //remove "second" cell
    get-cell -row 1 -column 3 | click
    select "Example 1/@{list} =" | key-type Del
    //remove "Length Should Be" cell
    get-cell -row 2 -column 0 | click
    select "Example 1/Length Should Be" | key-type Del
    //remove keyword name "WWW sum 2 digits"
    get-cell -row 10 -column 0 | click
    select "WWW sum 2 digits" |  key-type Del
    //remove line in keword
    select "Open Login Page/Open Browser" | key-type "M1+DEL"
}



get-editor "TestFile.robot" | get-tree | get-table-data | eq [read-csv-file [uri-from-path  [format "%s/TableEditor/KeywordsView/Verification/DeletingRowAndCellInKeywords.csv" $RCPTT_project_path] ] ]|
		 assert-true -message "Data in table does not match input file"
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

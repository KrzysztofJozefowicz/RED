--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _7-QNADzcEeWxlsQvwWxD9w
Element-Name: VerifyMenuForKeywordsButtons
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _AiR5UEA0EeW20a8v9jefTQ
Runtime-Version: 2.0.2.201511100828
Save-Time: 7/7/16 1:14 PM
Tags: notTestable
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

//toString can be changed to getText
proc "compare-menu" [val list_of_items]{
	repeat [val index] -times [get-editor "TestFile.robot" | get-tree |select [get-item "...add new keyword"] |  get-object  | invoke getMenu  | invoke	getItemCount |int]  -command
	{
		get-editor "TestFile.robot" | get-tree | select "...add new keyword" |  get-object  
		| invoke getMenu  | invoke getItem $index | invoke toString | equals [ $list_of_items| get $index]
	}
}

proc "check-menu-items" {
	with [get-editor "TestFile.robot" | get-tree] {
		//disable
	    get-menu "Add new keyword" | get-property caption | equals "Add new keyword" | verify-true
	    get-menu "Add new keyword" | get-property selection | equals false | verify-true
	    get-menu "Add new keyword" | get-property enablement | equals false | verify-true
	    get-menu "Add new keyword" | get-property index | equals 0 | verify-true
	    get-menu "Add new keyword" | get-property cascade | equals false | verify-true
	    
	    //disable
	    get-menu Cut | get-property caption | equals Cut | verify-true
	    get-menu Cut | get-property selection | equals false | verify-true
	    get-menu Cut | get-property enablement | equals false | verify-true
	    get-menu Cut | get-property index | equals 2 | verify-true
	    get-menu Cut | get-property accelerator | equals "M1+X" | verify-true
	    get-menu Cut | get-property cascade | equals false | verify-true
	    
	    //enable
	    get-menu Copy | get-property caption | equals Copy | verify-true
	    get-menu Copy | get-property selection | equals false | verify-true
	    get-menu Copy | get-property enablement | equals true | verify-true
	    get-menu Copy | get-property index | equals 3 | verify-true
	    get-menu Copy | get-property accelerator | equals "M1+C" | verify-true
	    get-menu Copy | get-property cascade | equals false | verify-true
	    
	    //disable
	    get-menu Paste | get-property caption | equals Paste | verify-true
	    get-menu Paste | get-property selection | equals false | verify-true
	    get-menu Paste | get-property enablement | equals false | verify-true
	    get-menu Paste | get-property index | equals 4 | verify-true
	    get-menu Paste | get-property accelerator | equals "M1+V" | verify-true
	    get-menu Paste | get-property cascade | equals false | verify-true
	    
	    //disable
	    get-menu Delete | get-property caption | equals Delete | verify-true
	    get-menu Delete | get-property selection | equals false | verify-true
	    get-menu Delete | get-property enablement | equals false | verify-true
	    get-menu Delete | get-property index | equals 5 | verify-true
	    get-menu Delete | get-property accelerator | equals Delete | verify-true
	    get-menu Delete | get-property cascade | equals false | verify-true
	    
	    //check menu for Table menu
	    //enable
	    get-menu "Table/Insert cell" | get-property caption | equals "Insert cell" | verify-true
	    get-menu "Table/Insert cell" | get-property selection | equals false | verify-true
	    get-menu "Table/Insert cell" | get-property enablement | equals true | verify-true
	    get-menu "Table/Insert cell" | get-property index | equals 0 | verify-true
	    get-menu "Table/Insert cell" | get-property accelerator | equals "M1+I" | verify-true
	    get-menu "Table/Insert cell" | get-property cascade | equals false | verify-true
	    
	    //enable
	    get-menu "Table/Delete cell" | get-property caption | equals "Delete cell" | verify-true
	    get-menu "Table/Delete cell" | get-property selection | equals false | verify-true
	    get-menu "Table/Delete cell" | get-property enablement | equals true | verify-true
	    get-menu "Table/Delete cell" | get-property index | equals 1 | verify-true
	    get-menu "Table/Delete cell" | get-property accelerator | equals "M1+D" | verify-true
	    get-menu "Table/Delete cell" | get-property cascade | equals false | verify-true
	
		//enable
	    get-menu "Table/Expand All" | get-property caption | equals "Expand All" | verify-true
	    get-menu "Table/Expand All" | get-property selection | equals false | verify-true
	    get-menu "Table/Expand All" | get-property enablement | equals true | verify-true
	    get-menu "Table/Expand All" | get-property index | equals 3 | verify-true
	    get-menu "Table/Expand All" | get-property cascade | equals false | verify-true
	    
	    get-menu "Table/Collapse All" | get-property caption | equals "Collapse All" | verify-true
	    get-menu "Table/Collapse All" | get-property selection | equals false | verify-true
	    get-menu "Table/Collapse All" | get-property enablement | equals true | verify-true
	    get-menu "Table/Collapse All" | get-property index | equals 4 | verify-true
	    get-menu "Table/Collapse All" | get-property cascade | equals false | verify-true
	    
	    //check Row item
	    //disable
	    get-menu "Row/Move up" | get-property caption | equals "Move up" | verify-true
	    get-menu "Row/Move up" | get-property selection | equals false | verify-true
	    get-menu "Row/Move up" | get-property enablement | equals false | verify-true
	    get-menu "Row/Move up" | get-property index | equals 0 | verify-true
	    get-menu "Row/Move up" | get-property accelerator | equals "M1+Up" | verify-true
	    get-menu "Row/Move up" | get-property cascade | equals false | verify-true
	    
	    //disable
	    get-menu "Row/Move down" | get-property caption | equals "Move down" | verify-true
	    get-menu "Row/Move down" | get-property selection | equals false | verify-true
	    get-menu "Row/Move down" | get-property enablement | equals false | verify-true
	    get-menu "Row/Move down" | get-property index | equals 1 | verify-true
	    get-menu "Row/Move down" | get-property accelerator | equals "M1+Down" | verify-true
	    get-menu "Row/Move down" | get-property cascade | equals false | verify-true
	    
	    get-menu "Row/Cut row" | get-property caption | equals "Cut row" | verify-true
	    get-menu "Row/Cut row" | get-property selection | equals false | verify-true
	    get-menu "Row/Cut row" | get-property enablement | equals false | verify-true
	    get-menu "Row/Cut row" | get-property index | equals 3 | verify-true
	    get-menu "Row/Cut row" | get-property accelerator | equals "M1+M2+X" | verify-true
	    get-menu "Row/Cut row" | get-property cascade | equals false | verify-true
	    
	    //disable
	    get-menu "Row/Copy row" | get-property caption | equals "Copy row" | verify-true
	    get-menu "Row/Copy row" | get-property selection | equals false | verify-true
	    get-menu "Row/Copy row" | get-property enablement | equals false | verify-true
	    get-menu "Row/Copy row" | get-property index | equals 4 | verify-true
	    get-menu "Row/Copy row" | get-property accelerator | equals "M1+M2+C" | verify-true
	    get-menu "Row/Copy row" | get-property cascade | equals false | verify-true
	    
	    //disable
	    get-menu "Row/Paste row" | get-property caption | equals "Paste row" | verify-true
	    get-menu "Row/Paste row" | get-property selection | equals false | verify-true
	    get-menu "Row/Paste row" | get-property enablement | equals false | verify-true
	    get-menu "Row/Paste row" | get-property index | equals 5 | verify-true
	    get-menu "Row/Paste row" | get-property accelerator | equals "M1+M2+V" | verify-true
	    get-menu "Row/Paste row" | get-property cascade | equals false | verify-true
	    
	    get-menu "Row/Delete row" | get-property caption | equals "Delete row" | verify-true
	    get-menu "Row/Delete row" | get-property selection | equals false | verify-true
	    get-menu "Row/Delete row" | get-property enablement | equals false | verify-true
	    get-menu "Row/Delete row" | get-property index | equals 6 | verify-true
	    get-menu "Row/Delete row" | get-property accelerator | equals "M1+Delete" | verify-true
	    get-menu "Row/Delete row" | get-property cascade | equals false | verify-true
	}
	
	//check menu Refactor and Reference
	with [get-editor "TestFile.robot" | get-tree] {
	    get-menu "Refactor/Rename" | get-property caption | equals Rename | verify-true
	    get-menu "Refactor/Rename" | get-property selection | equals false | verify-true
	    get-menu "Refactor/Rename" | get-property enablement | equals true | verify-true
	    get-menu "Refactor/Rename" | get-property index | equals 0 | verify-true
	    get-menu "Refactor/Rename" | get-property cascade | equals false | verify-true
	    
	    get-menu "Refactor/Extract to new keyword" | get-property caption | equals "Extract to new keyword" | verify-true
	    get-menu "Refactor/Extract to new keyword" | get-property selection | equals false | verify-true
	    get-menu "Refactor/Extract to new keyword" | get-property enablement | equals true | verify-true
	    get-menu "Refactor/Extract to new keyword" | get-property index | equals 1 | verify-true
	    get-menu "Refactor/Extract to new keyword" | get-property cascade | equals false | verify-true
	    
	    get-menu "Refactor/Assign to variable" | get-property caption | equals "Assign to variable" | verify-true
	    get-menu "Refactor/Assign to variable" | get-property selection | equals false | verify-true
	    get-menu "Refactor/Assign to variable" | get-property enablement | equals true | verify-true
	    get-menu "Refactor/Assign to variable" | get-property index | equals 2 | verify-true
	    get-menu "Refactor/Assign to variable" | get-property cascade | equals false | verify-true
	    
	    get-menu "References/Workspace" | get-property caption | equals Workspace | verify-true
	    get-menu "References/Workspace" | get-property selection | equals false | verify-true
	    get-menu "References/Workspace" | get-property enablement | equals false | verify-true
	    get-menu "References/Workspace" | get-property index | equals 0 | verify-true
	    get-menu "References/Workspace" | get-property accelerator | equals "M1+M2+G" | verify-true
	    get-menu "References/Workspace" | get-property cascade | equals false | verify-true
	    
	    get-menu "References/Project" | get-property caption | equals Project | verify-true
	    get-menu "References/Project" | get-property selection | equals false | verify-true
	    get-menu "References/Project" | get-property enablement | equals false | verify-true
	    get-menu "References/Project" | get-property index | equals 1 | verify-true
	    get-menu "References/Project" | get-property cascade | equals false | verify-true
	}
}

get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | select "RobotProject/TestFile.robot" 
    | double-click
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Keywords | click
    get-link "Section is not yet defined, do you want to create it?" | click
}

compare-menu -list_of_items [list "MenuItem {Add new keyword}" "MenuItem {|}" "MenuItem {Cut	M1+X}" "MenuItem {Copy	M1+C}" "MenuItem {Paste	M1+V}" "MenuItem {Delete	Delete}" "MenuItem {|}" "MenuItem {|}" "MenuItem {Open Declaration}"]

//check button
get-editor "TestFile.robot" | get-tree | get-item "...add new keyword" |click
//check menu items
check-menu-items

//add keyword and check "..." button
with [get-editor "TestFile.robot" | get-tree] {
    get-item "...add new keyword" | double-click
    select Keyword | activate-cell-edit
    get-editbox | key-type "NUMPAD_ENTER" "\\u000D"
    apply-cell-edit -deactivate
    key-type Right
}
//check menu items
get-editor "TestFile.robot" | get-tree | select "Keyword/..."
check-menu-items


------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: AddingKeywordByArrow
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _eg-JoD0eEeWUyZKiCzynFQ
Runtime-Version: 2.0.2.201511100828
Save-Time: 7/7/16 1:14 PM
Tags: notTestable
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

with [get-view "Project Explorer" | get-tree] {
    select RobotProject | select RobotProject | double-click
    select "RobotProject/TestFile.robot" | select "RobotProject/TestFile.robot" | double-click
}

// add Keywords section in Source 
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Source | click
    with [get-text-viewer] {
        set-caret-pos 1 19
        key-type Enter
		type-text "*** Keywords ***"
        key-type Enter
    }
    get-tab-folder | get-tab-item Keywords | click
}



get-editor "TestFile.robot" | get-tab-folder | get-tab-item Keywords | click    
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Keywords | click
    with [get-tree] {
    	
        get-item "...add new keyword"  | double-click
        select Keyword | activate-cell-edit
        with [get-editbox] {
            set-text "New keyword"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right -times 2
        key-type "M2+4" "$"
        select "New keyword" | activate-cell-edit -column 1
        with [get-editbox] {
            set-text "${a}"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type "M2+4" "$"
        select "New keyword" | activate-cell-edit -column 2
        with [get-editbox] {
            set-text "${b}"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type "M2+4" "$"
        select "New keyword" | activate-cell-edit -column 3
        with [get-editbox] {
            set-text "@{list}"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type "M2+4" "$"
        select "New keyword" | activate-cell-edit -column 4
        with [get-editbox] {
            set-text "${c}=55"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type "M2+4" "$"
        select "New keyword" | activate-cell-edit -column 5
        with [get-editbox] {
            set-text "${new var}=text"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        type-text c
        select "New keyword" | activate-cell-edit -column 6
        with [get-editbox] {
            set-text "comment 1"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Left -times 6
        key-type Down
        select "New keyword/..." | key-type Enter
        select "New keyword/" | activate-cell-edit
        with [get-editbox] {
            set-text "Set Log Level"
            key-type Enter -times 3
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type "NUMPAD_5" 5
        select "New keyword/Set Log Level" | activate-cell-edit -column 1
        with [get-editbox] {
            set-text 55
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Down
        select "New keyword/..." | key-type Down
        select "...add new keyword" | key-type Left
        key-type Enter
        select Keyword | activate-cell-edit
        with [get-editbox] {
            set-text "Second_keyword"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Down
        select "Second_keyword/..." | key-type "M2+l"
        select "Second_keyword/" | activate-cell-edit
        with [get-editbox] {
            set-text Log
            key-type Enter -times 3
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type "M2+h"
        select "Second_keyword/Log" | activate-cell-edit -column 1
        with [get-editbox] {
            set-text "Here is log"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right -times 5
        type-text c
        select "Second_keyword/Log" | activate-cell-edit -column 6
        with [get-editbox] {
            set-text "comment 2"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Down
        select "...add new keyword" | key-type Left -times 6
        key-type Enter
        select Keyword | activate-cell-edit
        with [get-editbox] {
            set-text "Last Keyword"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Down
        select "Last Keyword/..." | key-type Right -times 2
        key-type Enter
        select "Last Keyword/" | activate-cell-edit -column 2
        with [get-editbox] {
            set-text "second arg"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Left -times 2
        key-type "M2+l"
        select "Last Keyword/" | activate-cell-edit
        with [get-editbox] {
            set-text Log
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        type-text f
        
        select "Last Keyword/Log" | activate-cell-edit -column 1
        with [get-editbox] {
            set-text "fistr arg"
            key-type Enter
        }
        apply-cell-edit -deactivate
        
    }
}





get-editor "TestFile.robot" | get-tree | get-property itemCount | equals 4 | verify-true
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

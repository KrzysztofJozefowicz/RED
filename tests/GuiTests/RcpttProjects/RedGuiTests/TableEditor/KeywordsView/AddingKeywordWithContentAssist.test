--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _7-QNADzcEeWxlsQvwWxD9w
Element-Name: AddingKeywordWithContentAssist
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _kvQxgD0WEeWUyZKiCzynFQ
Runtime-Version: 2.0.0.201506120617
Save-Time: 8/11/15 1:45 PM
Testcase-Type: ecl
Verifications: _fNsf0D9aEeW20a8v9jefTQ

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | select "RobotProject/TestFile.robot" 
    | double-click
    
//add new keyword using assist and save file
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Keywords | click
    get-link "Section is not yet defined, do you want to create it?" | click
    with [get-tree] {
    	get-editor "TestFile.robot" | get-tab-folder | get-tab-item Keywords | click
        get-item "...add new keyword"  | double-click
        select Keyword | activate-cell-edit
        with [get-editbox] {
            set-text "New Keyword"
            key-type Enter
        }
        apply-cell-edit -deactivate
        get-item "New Keyword/..." |double-click
        select "New Keyword/" | activate-cell-edit
        with [get-editbox] {
            key-type "M1+SPACE"
            key-type Down -times 18
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type "NUMPAD_5" 5
        select "New Keyword/Convert To Hex" | activate-cell-edit -column 1
        with [get-editbox] {
            set-text 55
            key-type "NUMPAD_ENTER" "\\u000D"
        }
        apply-cell-edit -deactivate
        key-type "M1+s"
    }
}
//check if keyword was added
with [get-editor "TestFile.robot" | get-tree] {
    get-property itemCount | equals 2 | verify-true
    get-property "getItems().TreeItem[0].getText()" | equals "New Keyword"  | verify-true
    get-property "getItems().TreeItem[1].getText()" | equals "...add new keyword" | verify-true
    get-item "New Keyword" | get-property childCount | equals 2 | verify-true
    get-item "New Keyword/Convert To Hex" | get-property "columns[0]" | equals "Convert To Hex" | verify-true
    get-item "New Keyword/Convert To Hex" | get-property "columns[1]" | equals 55 | verify-true
    get-item "New Keyword/Convert To Hex" | get-property "columns[2]" | equals "   " | verify-true
    get-item "New Keyword/Convert To Hex" | get-property "columns[3]" | equals "" | verify-true
    get-item "New Keyword/Convert To Hex" | get-property "columns[4]" | equals "" | verify-true
    get-item "New Keyword/Convert To Hex" | get-property "columns[5]" | equals "" | verify-true
    get-item "New Keyword/Convert To Hex" | get-property "columns[6]" | equals "" | verify-true
}

//add 2 keywords
add-keyword-with-elements-by-double-click -keyword_name "WWW sum 2 digits" -elements [list "${b} =" "set variable" "${1}"] -script_name "TestFile.robot"
add-row-to-keyword-by-double-click-on-cell -keyword_name "WWW sum 2 digits" -keyword_index 0 -elements [list "${1} =" "set variable" "${2 }"] -script_name "TestFile.robot"
add-keyword-by-double-click -keywords_list [list "Empty keyword"]  -script_name "TestFile.robot"
with [get-editor "TestFile.robot" | get-tree] {
    get-item "...add new keyword"  | double-click
    select Keyword | activate-cell-edit
    with [get-editbox] {
        set-text "Check saved kw"
        key-type Enter
    }
    apply-cell-edit -deactivate
    key-type Right
    key-type Down
    //select New keyword
    select "Check saved kw/..." | key-type Enter
    select "Check saved kw/" | activate-cell-edit
    with [get-editbox] {
        key-type "M1+SPACE"
        key-type End
        set-text Up
        key-type Enter
    }
    apply-cell-edit -deactivate
    //add new keyword
    get-item "...add new keyword" | double-click
    select Keyword | activate-cell-edit
    with [get-editbox] {
        set-text "Check added kw"
        key-type Enter
    }
    apply-cell-edit -deactivate
    key-type Right
    key-type Down
    select "Check added kw/..." | key-type Enter
    select "Check added kw/" | activate-cell-edit
    //select "WWW sum 2 digits" keyword
    with [get-editbox] {
        key-type "M1+SPACE"
        key-type  End
        key-type Enter -times 2
    }
    apply-cell-edit -deactivate
}



------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

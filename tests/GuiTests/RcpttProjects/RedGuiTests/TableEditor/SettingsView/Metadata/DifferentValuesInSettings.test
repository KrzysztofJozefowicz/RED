--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _8u6XkDlIEeaMk_UgyvYHpA
Element-Name: DifferentValuesInSettings
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _RBRS8DlIEeaMk_UgyvYHpA
Runtime-Version: 2.0.2.201511100828
Save-Time: 7/4/16 9:39 AM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

proc "check-metadata-row"[val file] [val row] [val metadata] [val val] [val comment]{
	get-editor $file | get-section Metadata | get-canvas | get-object | invoke getCellByPosition 1 $row|  invoke getDataValue| eq $metadata |verify-true
	get-editor $file | get-section Metadata | get-canvas | get-object | invoke getCellByPosition 2 $row|  invoke getDataValue| eq $val |verify-true
	get-editor $file | get-section Metadata | get-canvas | get-object | invoke getCellByPosition 3 $row|  invoke getDataValue| eq $comment |verify-true

}


proc "check-imports-row" [val file] [val row] [val import] [val name] [val c1 ""] [val c2 ""] [val c3 ""] [val c4 ""] 
  [val c5 ""] [val c6 ""] [val c7 ""] [val c8 ""] [val c9 ""] [val c10 ""] [val c11 ""] [val default_length true]
{
	get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 1 $row|  invoke getDataValue| eq $import |verify-true
	get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 2 $row|  invoke getDataValue| eq $name |verify-true
	get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 3 $row|  invoke getDataValue| eq $c1 |verify-true
	get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 4 $row|  invoke getDataValue| eq $c2 |verify-true
	get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 5 $row|  invoke getDataValue| eq $c3 |verify-true
	get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 6 $row|  invoke getDataValue| eq $c4 |verify-true
	get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 7 $row|  invoke getDataValue| eq $c5 |verify-true
	
	if [$default_length | eq false]{
		get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 8 $row|  invoke getDataValue| eq $c6 |verify-true
		get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 9 $row|  invoke getDataValue| eq $c7 |verify-true
		get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 10 $row|  invoke getDataValue| eq $c8 |verify-true
		get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 11 $row|  invoke getDataValue| eq $c9 |verify-true
		get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 12 $row|  invoke getDataValue| eq $c10 |verify-true
		get-editor $file | get-section Imports | get-canvas | get-object | invoke getCellByPosition 13 $row|  invoke getDataValue| eq $c11 |verify-true
	}
}

proc "check-general-row" [val file] [val row] [val setting] [val c1 ""] [val c2 ""] [val c3 ""] [val c4 ""]  [val c5 ""]  [val c6 ""]
{
	get-editor $file | get-section General | get-canvas | get-object | invoke getCellByPosition 1 $row|  invoke getDataValue| eq $setting |verify-true
	get-editor $file | get-section General | get-canvas | get-object | invoke getCellByPosition 3 $row|  invoke getDataValue| eq $c1 |verify-true
	get-editor $file | get-section General | get-canvas | get-object | invoke getCellByPosition 4 $row|  invoke getDataValue| eq $c2 |verify-true
	get-editor $file | get-section General | get-canvas | get-object | invoke getCellByPosition 5 $row|  invoke getDataValue| eq $c3 |verify-true
	get-editor $file | get-section General | get-canvas | get-object | invoke getCellByPosition 6 $row|  invoke getDataValue| eq $c4 |verify-true
	get-editor $file | get-section General | get-canvas | get-object | invoke getCellByPosition 7 $row|  invoke getDataValue| eq $c5 |verify-true
	get-editor $file | get-section General | get-canvas | get-object | invoke getCellByPosition 8 $row|  invoke getDataValue| eq $c6 |verify-true
}


//open file
get-view "Project Explorer" | get-tree | select "SettingsProject/Script.robot" | double-click
get-editor "Script.robot" | get-tab-folder | get-tab-item Settings | click
get-editor "Script.robot" | get-section General | get-editbox -index 1 | get-property text 
    | equals "${a} @{b} &{c} - special characters !@#$%^&*()_+<>?:{}[]\n"
    + "\tNew line\n"
    + "Escaped tab: '\\t'with tab. Here: '\t'" | verify-true
    
    
with [get-editor "Script.robot"] {
    get-section General | click
}
get-editor "Script.robot" | get-section Metadata | click



check-metadata-row -file "Script.robot" -row 1 -metadata "data" -val "" -comment ""
check-metadata-row -file "Script.robot" -row 2 -metadata "line1" -val "line2" -comment ""
check-metadata-row -file "Script.robot" -row 3 -metadata "I like" -val "pancake!" -comment "# Johnny | Bravo"


with [get-editor "Script.robot"] {
    get-section Metadata | click
    get-section Imports | click
}


check-imports-row -file "Script.robot" -row 1 -import "Resource" -name "res3.robot" -c11 "#here is param" -default_length false
check-imports-row -file "Script.robot" -row 2 -import "Library" -name "String" -default_length false
check-imports-row -file "Script.robot" -row 3 -import "Library" -name "Collections" -default_length false
check-imports-row -file "Script.robot" -row 4 -import "Library" -name "Telnet" -default_length false
check-imports-row -file "Script.robot" -row 5 -import "Library" -name "XML"  -c1 "arg1" -c2 "arg2" -c3 "arg3" -c4 "arg4" -c5 "arg5" -default_length false

check-imports-row -file "Script.robot" -row 6 -import "Resource" -name "folder/inside/res2.tsv" -default_length false
check-imports-row -file "Script.robot" -row 7 -import "Variables" -name "libs/lib1.py"  -c1 "1" -c2 "2" -c3 "3" -c4 "4" -c5 "5" -c6 "6" -c7 "7" -c8 "8" -c9 "9" -c10 "10" -default_length false
check-imports-row -file "Script.robot" -row 8 -import "Library" -name "MyLibrary"  -c1 "my1" -c2 "\\" -c3 "my2" -c4 "\\\\" -c5 "my3" -default_length false
check-imports-row -file "Script.robot" -row 9 -import "Library" -name "${LIBRARY}" -default_length false
check-imports-row -file "Script.robot" -row 10 -import "Variables" -name "${a}/\ folder/file.py"  -default_length false
check-imports-row -file "Script.robot" -row 11 -import  "Variables" -name "libs/lib1.py" -c1 "val1" -c2 "val2" -c11 "#my value | # no more vals" -default_length false



//========================tsv file =====================================
get-view "Project Explorer" | get-tree | select "SettingsProject/Test.tsv" | double-click
get-editor "Test.tsv" | get-tab-folder | get-tab-item Settings | click

with [get-editor "Test.tsv"] {
    get-section General | click
    get-section Metadata | click
}

check-metadata-row -file "Test.tsv" -row 1 -metadata "\\" -val "${EMPTY}" -comment ""
check-metadata-row -file "Test.tsv" -row 2 -metadata "tsv" -val "multiline" -comment ""

with [get-editor "Test.tsv"] {
    get-section Metadata | click
    get-section Imports | click
}

check-imports-row -file "Test.tsv" -row 1 -import "Variables" -name "../../no lib/libs/lib1.py" -c1 "this is arg to variables"
check-imports-row -file "Test.tsv" -row 2 -import "Library" -name "${CURDIR}${/}..${/}resource${/}throughput_check.py" -c5 "# here is error"
check-imports-row -file "Test.tsv" -row 3 -import "Library" -name "Collections" -c1 "collect1" -c2 "collect2"
check-imports-row -file "Test.tsv" -row 4 -import "Library" -name "XML"
check-imports-row -file "Test.tsv" -row 5 -import "Resource" -name "folder\\inside\\res2.tsv"
check-imports-row -file "Test.tsv" -row 6 -import "Library" -name "${EXECDIR}${/}testsuite${/}DCM${/}libraries${/}log_analyzer${/}mmt${/}common${/}MMTCommonMessageAnalyse.py"



//=============================== empty resource ==========================================================================================
get-view "Project Explorer" | get-tree | select "SettingsProject/res.robot" | double-click
get-editor "res.robot" | get-tab-folder | get-tab-item Settings | click
get-editor "res.robot" | get-section General | get-editbox -index 1 | get-property text | equals "" | verify-true
with [get-editor "res.robot"] {
    with [get-section General] {
        click
    }
    get-section Imports | click
}
 
//========================================= tsv resource ======================================================

get-view "Project Explorer" | get-tree | select "SettingsProject/res3.tsv" | double-click
get-editor "res3.tsv" | get-tab-folder | get-tab-item Settings | click

get-editor "res3.tsv" | get-section General | get-editbox -index 1 | get-property text | equals "Resoure doc\n"
    + "with 2 lines..." | verify-true

check-imports-row -file "res3.tsv" -row 1 -import "Library" -name "OperatingSystem" 
check-imports-row -file "res3.tsv" -row 2 -import "Variables" -name "libs/lib1.py" 



------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

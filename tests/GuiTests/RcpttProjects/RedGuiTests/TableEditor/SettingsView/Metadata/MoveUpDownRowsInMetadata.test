--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: MoveUpDownRowsInMetadata
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _MWfzsDiJEeas8aQC5hr2rw
Runtime-Version: 2.0.2.201511100828
Save-Time: 6/22/16 5:54 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

//open editor
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click

//add Metada
get-editor "TestFile.robot" | get-text-viewer | set-text "*** Settings ***\n"
    + "Metadata    a1    1    #comment1\n"
    + "Metadata    a2    2    #comment2\n"
    + "Metadata    a3    3    #comment3\n"
    + "Metadata    a4    4    #comment4\n"
    + "Metadata    a5    5    #comment5\n"
    + "Metadata    a6    6    #comment6\n"
    + "Metadata    a7    7    #comment7\n"
    + "Metadata    a8    8    #comment8\n"
    + "Metadata    a9    9    #comment9\n\n"
    + "*** Test Cases ***\n"
    + "test\n"
    + "    log  7"
    
//open Settings tab
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Settings | click
    get-section General | click
    get-section Metadata | click
}

//move values
with [get-editor "TestFile.robot" | get-section Metadata | get-canvas] {
	//move a8 down by menu
    mouse-press 76 192 button1
    mouse-release 76 192 button1 524288
    mouse-press 76 192 button3
    mouse-release 76 192 button3 2097152
    get-menu "Row/Move up" | click
    
    //move value 5 by arrows
    mouse-move 323 117
    mouse-press 323 117 button1
    mouse-release 323 117 button1 524288
    key-type "M1+ARROW_UP"
    
    //move value a3 up by menu
    mouse-move 606 78
    mouse-press 606 78 button1
    mouse-release 606 78 button1 524288
    mouse-press 606 78 button3
    mouse-release 606 78 button3 2097152
    get-menu "Row/Move up" | click
    
    //move comment4 down by menu
    mouse-move 632 124
    mouse-press 632 124 button1
    mouse-release 632 124 button1 524288
    mouse-press 632 124 button3
    mouse-release 632 124 button3 2097152
    get-menu "Row/Move down" | click
    
    //move a7 down by arrow
    mouse-move 138 178
    mouse-press 138 178 button1
    mouse-release 138 178 button1 524288
    key-type "M1+ARROW_DOWN"
    
    //move first value up (nothing should happen)
    mouse-move 88 32
    mouse-press 88 32 button1
    mouse-release 88 32 button1 524288
    mouse-press 88 32 button3
    mouse-release 88 32 button3 2097152
    get-menu "Row/Move up" | click
    
    //move last value down (nothong should happen)
    mouse-move 332 208
    mouse-press 332 208 button1
    mouse-release 332 208 button1 524288
    mouse-press 332 208 button3
    mouse-release 332 208 button3 2097152
    get-menu "Row/Move down" | click
    mouse-move 924 328
}

proc "check-values-in-row" [val row] [val metadata] [val val] [val comment]{
	get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object | invoke getCellByPosition 1 $row|  invoke getDataValue| eq $metadata |verify-true
	get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object | invoke getCellByPosition 2 $row|  invoke getDataValue| eq $val |verify-true
	get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object | invoke getCellByPosition 3 $row|  invoke getDataValue| eq $comment |verify-true

}

check-values-in-row -row 1 -metadata "a1" -val "1" -comment "#comment1"
check-values-in-row -row 2 -metadata "a3" -val "3" -comment "#comment3"
check-values-in-row -row 3 -metadata "a2" -val "2" -comment "#comment2"
check-values-in-row -row 4 -metadata "a5" -val "5" -comment "#comment5"

check-values-in-row -row 5 -metadata "a6" -val "6" -comment "#comment6"
check-values-in-row -row 6 -metadata "a4" -val "4" -comment "#comment4"
check-values-in-row -row 7 -metadata "a8" -val "8" -comment "#comment8"
check-values-in-row -row 8 -metadata "a9" -val "9" -comment "#comment9"
check-values-in-row -row 9 -metadata "a7" -val "7" -comment "#comment7"


//test dla przesuwania z focem:

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

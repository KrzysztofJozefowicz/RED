--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: EditMetadata
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _KeFc8P4OEeSvjNrJkS7N6Q
Runtime-Version: 1.5.5.201503020312
Save-Time: 6/30/15 12:36 PM
Testcase-Type: ecl

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa
Content-Type: text/plain
Entry-Name: .description

Testcase:
1. Creates 'Settings' section
2. Adds 2 'Metadata' entries, verifies if they appeared in text view
3. Deletes 1 of them, verifies if it is removed from text view
4. Adds 1 mode entry, verifies if it appeared in text view
------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa--
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Settings | click
    get-link "Section is not yet defined, do you want to create it?" | click
}
with [get-editor "TestFile.robot"] {
    with [get-section Metadata | get-table] {
        select "...add new metadata" | key-type Enter
        click -default
        select data | activate-cell-edit
        with [get-editbox] {
            set-text Metadata
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Enter
        select Metadata | activate-cell-edit -column 1
        click -default
        with [get-editbox] {
            set-text 5
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Enter
        select Metadata | activate-cell-edit -column 2
        click -default
        with [get-editbox] {
            set-text Comment
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Left -times 2
        key-type Down
        select "...add new metadata" | key-type Enter
        click -default
        select data | activate-cell-edit
        with [get-editbox] {
            set-text OtherData
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Enter
        select OtherData | activate-cell-edit -column 1
        click -default
        with [get-editbox] {
            set-text value
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Enter
        select OtherData | activate-cell-edit -column 2
        click -default
        with [get-editbox] {
            set-text "Other comment"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type "M1+s"
    }
    close
}
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-editor "TestFile.robot" | get-text-viewer | get-property text | contains "Metadata    Metadata    5    # Comment\r\n"
    + "Metadata    OtherData    value    # Other comment" | verify-true
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Settings | click
    with [get-section Metadata | get-table] {
        select OtherData | key-type Del
        key-type "M1+s"
    }
    close
}
wait 500
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-editor "TestFile.robot" | get-text-viewer | get-property text | contains "Metadata    OtherData    value    # Other comment" | verify-false

with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Settings | click
    with [get-section Metadata | get-table] {
        select Metadata | key-type Down
        select "...add new metadata" | key-type "NUMPAD_ENTER" "\\u000D"
        click -default
        key-type Right
        select data | key-type Enter
        select data | activate-cell-edit -column 1
        click -default
        with [get-editbox] {
            set-text data
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type Right
        key-type Enter
        select data | activate-cell-edit -column 2
        click -default
        with [get-editbox] {
            set-text "third comment"
            key-type Enter
        }
        apply-cell-edit -deactivate
        key-type "M1+s"
    }
    close
}
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-editor "TestFile.robot" | get-text-viewer | get-property text | contains "Metadata    Metadata    5    # Comment\r\n"
    + "Metadata    data    data    # third comment" | verify-true 
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

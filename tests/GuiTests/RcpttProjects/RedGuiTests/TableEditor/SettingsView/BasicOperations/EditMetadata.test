--- RCPTT testcase ---
Format-Version: 1.0
Element-Name: EditMetadata
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _KeFc8P4OEeSvjNrJkS7N6Q
Runtime-Version: 2.0.2.201511100828
Save-Time: 6/9/16 5:58 PM
Tags: Unstable
Testcase-Type: ecl

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa
Content-Type: text/plain
Entry-Name: .description

Testcase:
 Creates 'Settings' section
 Adds one metadata line 
 Check if it visible in Text editor
 Add 2 more & check
 delete middle one by removing each row & check
 delete whole row & check

------=_.description-216f885c-d591-38ce-8ea2-e4f8cb4d6ffa--
------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
with [get-editor "TestFile.robot"] {
    get-tab-folder | get-tab-item Settings | click
    get-link "Section is not yet defined, do you want to create it?" | click
}

with [get-editor "TestFile.robot"] {
    get-section General | click
    get-section Metadata | click
}

//metadata: new
with [get-editor "TestFile.robot"] {
    with [get-section Metadata] {
        with [get-canvas] {
            mouse-move 118 33
            mouse-press 118 33 button1
            mouse-release 118 33 button1 524288
            mouse-press 118 33 button1
            mouse-double-click 118 33 button1
            mouse-release 118 33 button1 524288
        }
        with [get-editbox] {
            type-text new
            key-type Enter
        }
        //value: text
        with [get-canvas] {
            mouse-move 386 31
            mouse-press 386 31 button1
            mouse-release 386 31 button1 524288
            mouse-press 386 31 button1
            mouse-double-click 386 31 button1
            mouse-release 386 31 button1 524288
        }
        with [get-editbox] {
            type-text text
            key-type Enter
        }
        get-editbox | key-type "M1+s"
        get-canvas | mouse-move 361 144
    }
    get-tab-folder | get-tab-item Source | click
}
get-editor "TestFile.robot" | get-text-viewer | get-property text | equals "*** Setting ***\n"
    + "Metadata\tnew\ttext\n"
    + "*** Test Cases ***" | verify-true
    
//add to Source metadata
with [get-editor "TestFile.robot"] {
    with [get-text-viewer] {
        set-caret-pos 2 21
        key-type "NUMPAD_ENTER" "\\u000D"
        key-type "M1+SPACE"
        type-text me
        key-type Enter
        type-text "Second line  is here  #with comment"
        key-type "M1+s"
       
    }
    get-tab-folder | get-tab-item Settings | click
     wait 3000
}


//check if added in Source is shown in table
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 1 1| invoke getDataValue| eq "new" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 2 1| invoke getDataValue| eq "text" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 3 1| invoke getDataValue| eq "" |verify-true

try -times 5 -delay 1000 -command{
	get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 1 2| invoke getDataValue| eq "Second line" |verify-true
	get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 2 2| invoke getDataValue| eq "is here" |verify-true
	get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 3 2| invoke getDataValue| eq "#with comment" |verify-true
}

//add new line
with [get-editor "TestFile.robot" | get-section Metadata] {
	//add default value
    with [get-canvas] {
        mouse-press 129 74 button1
        mouse-release 129 74 button1 524288
        mouse-press 129 74 button1
        mouse-double-click 129 74 button1
        mouse-release 129 74 button1 524288
    }
    get-editbox | key-type Enter
    with [get-canvas] {
        mouse-move 297 69
        mouse-press 297 69 button1
        mouse-release 297 69 button1 524288
        mouse-press 297 69 button1
        mouse-double-click 297 69 button1
        mouse-release 297 69 button1 524288
    }
    //add value
    with [get-editbox] {
        type-text "CAPITAL CASE"
        key-type Enter
    }
}
//check source    
get-editor "TestFile.robot" | get-tab-folder | get-tab-item Source | click
get-editor "TestFile.robot" | get-text-viewer | get-property text | equals "*** Setting ***\n"
    + "Metadata\tnew\ttext\n"
    + "Metadata    Second line  is here  #with comment\n"
    + "Metadata\tdata\tCAPITAL CASE\n"
    + "*** Test Cases ***" | verify-true


   
with [get-editor "TestFile.robot"] {
    with [get-text-viewer] {
        set-caret-pos 5 19
        key-type "M1+s"
    }
}

with [get-editor "TestFile.robot"] {    
    get-tab-folder | get-tab-item Settings | click
    
}    
with [get-editor "TestFile.robot" | get-section Metadata | get-canvas] {
    mouse-press 40 31 button1
    mouse-release 40 31 button1 524288
    mouse-move 1050 166
}
    
with [get-editor "TestFile.robot"] {    

    with [get-section Metadata | get-canvas] {
        mouse-press 49 74 button1
        mouse-release 49 74 button1 524288
        mouse-press 49 74 button3
        mouse-release 49 74 button3 2097152
        get-menu "Row/Delete row" | click
        mouse-move 62 51
        mouse-press 62 51 button3
        mouse-release 62 51 button3 2097152
        get-menu "Row/Copy row" | click
        mouse-move 67 37
        mouse-press 67 37 button1
        mouse-release 67 37 button1 524288
        mouse-press 67 37 button3
        mouse-release 67 37 button3 2097152
        get-menu "Row/Paste row" | click
        mouse-move 988 135
    }
}    


//check if added in Source is shown in table
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 1 1| invoke getDataValue| eq "Second line" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 2 1| invoke getDataValue| eq "is here" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 3 1| invoke getDataValue| eq "#with comment"  |verify-true

get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 1 2| invoke getDataValue| eq "new" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 2 2| invoke getDataValue| eq "text" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 3 2| invoke getDataValue| eq "" |verify-true



get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 1 3| invoke getDataValue| eq "Second line" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 2 3| invoke getDataValue| eq "is here" |verify-true
get-editor "TestFile.robot" | get-section Metadata | get-canvas | get-object| invoke getCellByPosition 3 3| invoke getDataValue| eq "#with comment" |verify-true


------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

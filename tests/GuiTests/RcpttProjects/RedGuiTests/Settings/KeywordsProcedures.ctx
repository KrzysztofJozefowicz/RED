--- RCPTT testcase ---
Format-Version: 1.0
Context-Type: org.eclipse.rcptt.ctx.ecl
Element-Name: KeywordsProcedures
Element-Type: context
Element-Version: 2.0
Id: _7-QNADzcEeWxlsQvwWxD9w
Runtime-Version: 2.0.0.201506120617
Save-Time: 8/7/15 5:09 PM

------=_.ecl.context-718f04b4-ed39-33e3-af62-0995e4561998
Content-Type: text/ecl
Entry-Name: .ecl.context

proc "add-keyword-by-double-click" [val keywords_list] [val script_name]{
	$keywords_list| each [val keyword]{
		with [get-editor $script_name | get-tree] {
			get-item "...add new keyword" | double-click
		    with [get-editbox]{
		    	set-text $keyword
		        key-type Enter
		   	}
		    apply-cell-edit -deactivate
		}
	}
}


proc "add-keywords-by-typing-enter" [val keywords_list] [val script_name]{
	$keywords_list| each [val keyword]{
		with [get-editor $script_name | get-tree] {
			get-item  "...add new keyword" | click
			key-type Enter
		    with [get-editbox]{
		    	set-text $keyword
		        key-type Enter
		   	}
		    apply-cell-edit -deactivate
		}
	}
}

proc "add-row-to-keyword-by-arrows-end-enter" [val keyword_name] [val keyword_index] [val elements] [val script_name] {
	
	$elements| each [val element] [val index]{
		$elements |get 0| let [val first_element -input]{
			with [get-editor $script_name | get-tree] {
				if [$index | equals 0]{
					select [get-item $keyword_name -index $keyword_index | get-item "\.\.\."] | key-type Enter
   					select [get-item $keyword_name -index $keyword_index | get-item ""] | activate-cell-edit
				    with [get-editbox] {
				        set-text $element
			        	key-type Enter
			    	}
			    	apply-cell-edit -deactivate    	
		    	}-else{
		    		key-type Right
				    key-type Enter		
				    with [get-editbox] {
				    	set-text $element
				        key-type Enter
				    }
				    apply-cell-edit -deactivate
				}
			}	
		} 	
	}
}

proc "add-row-to-keyword-by-double-click-on-cell" [val keyword_name] [val keyword_index] [val elements] [val script_name]{
	$elements| each [val element] [val index]{
		$elements |get 0| let [val first_element -input]{
			with [get-editor $script_name | get-tree] {
				if [$index | equals 0]{
				    get-item $keyword_name -index $keyword_index| get-item "..." | double-click
				    with [get-editbox] {
				        set-text $element
			        	key-type Enter
			    	}
			    	apply-cell-edit -deactivate
		    	
		    	}-else{
		    		select [format "%s/%s" $keyword_name $first_element]|double-click
		    		select  [format "%s/%s" $keyword_name $first_element] | activate-cell-edit -column $index
				    with [get-editbox] {
				    	set-text $element
				        key-type Enter
				    }
				    apply-cell-edit -deactivate			   
				}
			}	
		} 	
	}
}


proc "add-keyword-with-args-by-arrows" [val keywords_name] [val arguments] [val script_name]{
	with [get-editor $script_name | get-tree] {
		get-item "...add new keyword"| click 
		//select "...add new keyword"| key-type Enter
		key-type Enter
		    with [get-editbox]{
		    	set-text $keywords_name
		        key-type Enter
		   	}
		    apply-cell-edit -deactivate
		    key-type Right -times 1
		    
	    	$arguments| each [val argument] [val index]{
				with [get-editor $script_name | get-tree] {
					key-type Right -times 1
					key-type Enter
					with [get-editbox] {
		            	set-text $argument
		            	key-type Enter
	        		}
        			apply-cell-edit -deactivate
			    }
		   }
	  }
} 


proc "add-keyword-with-args-by-double-click" [val keyword_name] [val arguments] [val script_name]{ 
	with [get-editor $script_name | get-tree] {
		get-item "...add new keyword" | double-click
	    with [get-editbox]{
	    	set-text $keyword_name
	        key-type Enter
	   	}
	    apply-cell-edit -deactivate
	    
    	$arguments| each [val argument] [val index]{
			with [get-editor $script_name | get-tree] {
				select [format "%s/%s" $keyword_name $first_element]
				select [format "%s/%s" $keyword_name $first_element] | activate-cell-edit -column [plus $index 1]
				get-editbox | set-text $argument
				apply-cell-edit -deactivate
    		}
		}
	}
}

proc "add-keyword-with-elements-by-arrows" [val keyword_name] [val elements]  [val script_name]{
	with [get-editor $script_name | get-tree] {
		get-item  "...add new keyword" | click
		key-type Enter

	    with [get-editbox]{
	    	set-text $keyword_name
	        key-type Enter
	 
	   	}
	    apply-cell-edit -deactivate
	    key-type Right -times 1
	}

	$elements| each [val element] [val index]{
		$elements |get 0| let [val first_element -input]{
			with [get-editor $script_name | get-tree] {
				if [$index | equals 0]{
					get-item $keyword_name| get-item "..."| click
				    key-type Enter
				    with [get-editbox] {
				        set-text $element
			        	key-type Enter
			    	}
			    	apply-cell-edit -deactivate    	
		    	}-else{
		    		key-type Right
				    key-type Enter		
				    with [get-editbox] {
				    	set-text $element
				        key-type Enter
				    }
				    apply-cell-edit -deactivate
				}
			}	
		} 	
	}
}

proc "add-keyword-with-elements-by-double-click" [val keyword_name] [val elements] [val script_name]{
	with [get-editor $script_name | get-tree] {
		get-item "...add new keyword" | double-click
	    with [get-editbox]{
	    	set-text $keyword_name
	        key-type Enter
	   	}
	    apply-cell-edit -deactivate
	}

   $elements| each [val element] [val index]{
		$elements |get 0| let [val first_element -input]{
			with [get-editor $script_name | get-tree] {
				if [$index | equals 0]{
				    get-item $keyword_name | get-item "..." | double-click
				    with [get-editbox] {
				        set-text $element
			        	key-type Enter
			    	}
			    	apply-cell-edit -deactivate
		    	
		    	}-else{
		    	   select [format "%s/%s" $keyword_name $first_element] | double-click
				   select [format "%s/%s" $keyword_name $first_element] | activate-cell-edit -column $index
				    with [get-editbox] {
				    	set-text $element
				        key-type Enter
				    }
				    apply-cell-edit -deactivate			   
				}
			}	
		} 	
	}
}


------=_.ecl.context-718f04b4-ed39-33e3-af62-0995e4561998--

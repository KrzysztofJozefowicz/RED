--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _QxfxAKjOEeWg6OFh_tHgTw
Element-Name: ExcudingFolederInRedXml
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _-2m5wKjCEeWg6OFh_tHgTw
Runtime-Version: 2.0.2.201511100828
Save-Time: 12/22/15 6:53 PM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

//check of are 5 errors
with [get-view Problems | get-tree] {
    get-item "Errors \\(5 items\\)" | get-property childCount | equals 5 | verify-true
    get-item "Errors \\(5 items\\)" | get-property "getItems().TreeItem[0].getText()" 
        | equals "Test case 'empty test case' contains no keywords to execute" | verify-true
    get-item "Errors \\(5 items\\)" | get-property "getItems().TreeItem[1].getText()" 
        | equals "Unknown 'no_lib' library. Try to use Quick Fix (Ctrl+1) or add library to red.xml for proper validation" 
        | verify-true
    get-item "Errors \\(5 items\\)" | get-property "getItems().TreeItem[2].getText()" 
        | equals "Unknown keyword 'kw from file to remove'" | verify-true
    get-item "Errors \\(5 items\\)" | get-property "getItems().TreeItem[3].getText()" 
        | equals "Unknown keyword 'kw from file_with_error'" | verify-true
    get-item "Errors \\(5 items\\)" | get-property "getItems().TreeItem[4].getText()" 
        | equals "Unknown keyword 'kw from testSuite'" | verify-true
}
//open red.xml
get-view "Project Explorer" | get-tree | select "RobotProject/red.xml" | double-click
get-editor "RobotProject/red.xml" | get-tab-folder | get-tab-item Validation | click

//check if default option is Exclude
get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree 
    | select "RobotProject/folder_to_remove"
with [get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree] {
    get-menu Include | get-property enablement | equals false | verify-true
    get-menu Exclude | get-property enablement | equals true | verify-true
}

//change exclude
get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree 
    | select "RobotProject/folder_to_remove" | get-menu Exclude | click
    
with [get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree] {
    get-menu Include | get-property enablement | equals true | verify-true
    get-menu Exclude | get-property enablement | equals false | verify-true
}    

//change to include    
get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree 
    | select "RobotProject/folder_to_remove [excluded]" | get-menu Include | click
wait 200
with [get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree] {
    get-menu Include | get-property enablement | equals false | verify-true
    get-menu Exclude | get-property enablement | equals true | verify-true
}

//exclude
with [get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree] {
    select "RobotProject/folder_to_remove" | get-menu Exclude | click
    double-click
}

//add exclude of folder
with [get-editor "RobotProject/red.xml" | get-section "Excluded project parts" | get-tree] {
    select "RobotProject/a/b" | double-click
    wait 200
    select "RobotProject/a/b/c1" | get-menu Exclude | click
    select "RobotProject/a/b" | get-menu Exclude | click
    select "RobotProject/variables" | get-menu Exclude | click
    select "RobotProject/empty folder" | get-menu Exclude | click
    select "RobotProject/tests" | get-menu Exclude | click
}

get-button "Save (M1+S)" | click


get-view "Project Explorer" | get-tree | select "RobotProject/[excluded] folder_to_remove" | get-menu Delete | click
get-window "Delete Resources" | get-button OK | click
get-view "Project Explorer" | get-tree | select RobotProject | get-menu "New/Folder" | click
with [get-window "New Folder"] {
    get-editbox -after [get-label "Folder name:"] | set-text "new folder"
    get-button Finish | click
}
get-view "Project Explorer" | get-tree | select "RobotProject/TestFile.robot" | double-click
get-button "Run TestFile.robot" | click
get-view "Project Explorer" | get-tree | select "SecondProject/red.xml" | double-click


------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--

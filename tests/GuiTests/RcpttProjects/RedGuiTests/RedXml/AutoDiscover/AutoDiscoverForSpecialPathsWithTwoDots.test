--- RCPTT testcase ---
Format-Version: 1.0
Contexts: _2inTAIJTEeeVzuwK_hMKqA,_2JCD4B3CEeehL98jfxP8Sw
Element-Name: AutoDiscoverForSpecialPathsWithTwoDots
Element-Type: testcase
Element-Version: 3.0
External-Reference: 
Id: _PqJNkIJTEeeVzuwK_hMKqA
Runtime-Version: 2.1.0.201606221726
Save-Time: 8/16/17 11:42 AM
Testcase-Type: ecl

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac
Content-Type: text/ecl
Entry-Name: .content

// open test file
with [get-view "Project Explorer" | get-tree] {
    select AutoProject | double-click
    select "AutoProject/test" | double-click
    select "AutoProject/test/test.robot" | double-click
}
// add . to path and save (autodiscover run)
with [get-editor "test.robot" | get-text-viewer] {
    set-caret-pos 2 11
    type-text "."
    key-type "M1+s"
}
// save red.xml
get-view "Project Explorer" | get-tree | select "AutoProject/red.xml" | double-click
with [get-editor "AutoProject/red.xml"] {
    get-tab-folder | get-tab-item "Referenced libraries" | click
    get-section "Referenced libraries" | get-table | select "discover - AutoProject\\/libs" | key-type "M1+s"
}
// check Problem if there is 0 items
get-view Problems | click
get-editor "test.robot" | click
get-editor "AutoProject/red.xml" | close
with [get-editor "test.robot" | get-text-viewer] {
    set-caret-pos 2 29
}
wait -ms 5000
wait-for-zero-items -times 4 -delay 1000
// verify if library was added to Robot Referenced libraries
get-view "Project Explorer" | get-tree | select "AutoProject/Robot Referenced libraries" | double-click
get-view "Project Explorer" | get-tree 
    | get-item "AutoProject/Robot Referenced libraries/discover AutoProject\\/libs \\(1\\)" | get-property "getText()" 
    | equals "discover AutoProject/libs (1)" | verify-true
// remove lib from red.xml
get-view "Project Explorer" | get-tree | select "AutoProject/red.xml" | double-click
with [get-editor "AutoProject/red.xml" | get-section "Referenced libraries" | get-table] {
    select "discover - AutoProject\\/libs" | key-type Del
    key-type "M1+s"
}
// set wrong path and start QuickFix, choose valid path
get-editor "test.robot" | click
get-editor "AutoProject/red.xml" | close
with [get-editor "test.robot" | get-text-viewer] {
    set-caret-pos 2 12
    key-type BackSpace
    wait -ms 1000
    set-caret-pos 2 26
    key-type "M1+1"
    key-type Down
    key-type Enter
    key-type "M1+s"
}
// check if there is no Problems
wait-for-zero-items -times 4 -delay 1000
// set agin wrong path and use QF
with [get-editor "test.robot" | get-text-viewer] {
    set-caret-pos 2 17
    key-type BackSpace
    wait -ms 1000
    set-caret-pos 2 26
    key-type "M1+1"
    key-type Down
    key-type Enter
}
// check if no Problems
get-eclipse-window | key-type "M1+s"
get-view Problems | get-label "0 items" | get-property caption | equals "0 items" | verify-true
// make path withou extension
with [get-editor "test.robot" | get-text-viewer] {
    set-caret-pos 2 33
    key-type BackSpace -times 4
}
// verify Problems
get-view Problems | click
wait-for-errors -amount 2 -times 4 -delay 500
with [get-editor "test.robot" | get-text-viewer] {
    set-caret-pos 2 25
    key-type "M1+1"
    set-caret-pos 2 22
    key-type "M1+2"
    key-type "M1+1"
    hover-text 2 18
}
// verify QF items list
get-window -from "CompletionProposalPopup.createProposalSelector()" | get-table 
    | get-property "getItems().TableItem[0].getText()" | equals "Discover '../libs/discover' and add to configuration" 
    | verify-true
with [get-editor "test.robot" | get-text-viewer] {
    hover-text 2 18
    set-caret-pos 2 20
    key-type "M1+1"
}
get-window -from "CompletionProposalPopup.createProposalSelector()" | get-table 
    | get-property "getItems().TableItem[0].getText()" | equals "Discover '../libs/discover' and add to configuration" 
    | verify-true
with [get-window -from "CompletionProposalPopup.createProposalSelector()" | get-table] {
    select "Discover '..\\/libs\\/discover' and add to configuration" | key-type Enter
    click -default
}
// empty lib list
get-window "Discovering libraries summary" | get-button OK | click
get-editor "test.robot" | get-text-viewer | set-caret-pos 2 23
with [get-editor "test.robot" | get-text-viewer] {
    set-caret-pos 2 22
    key-type "M1+1"
    key-type Enter
}
get-window "Discovering libraries summary" | get-tree | get-property itemCount | equals 0 | verify-true
get-window "Discovering libraries summary" | get-button OK | click

------=_.content-0a7243a0-75d3-3d5f-9791-539de0e5b7ac--
